<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JARVIS - AI Assistant</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 212, 255, 0.3);
        }

        .logo p {
            color: #888;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .quick-actions {
            margin-bottom: 30px;
        }

        .quick-actions h3 {
            font-size: 1rem;
            margin-bottom: 15px;
            color: #ccc;
            font-weight: 500;
        }

        .action-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.85rem;
        }

        .action-btn:hover {
            background: rgba(0, 212, 255, 0.2);
            border-color: #00d4ff;
            transform: translateY(-2px);
        }

        .action-btn i {
            display: block;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .status {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-top: auto;
        }

        .status h4 {
            font-size: 0.9rem;
            margin-bottom: 10px;
            color: #ccc;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00ff88;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.02);
        }

        .header {
            padding: 20px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
        }

        .header h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .header p {
            color: #888;
            font-size: 0.9rem;
        }

        .chat-container {
            flex: 1;
            padding: 20px 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .welcome-message {
            text-align: center;
            margin: auto;
            max-width: 500px;
        }

        .welcome-message h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #00d4ff;
        }

        .welcome-message p {
            color: #aaa;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .chat-messages {
            display: none;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .message {
            display: flex;
            gap: 12px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
        }

        .message.jarvis .message-avatar {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }

        .message-content {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            padding: 12px 18px;
            max-width: 70%;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
        }

        .message-time {
            font-size: 0.75rem;
            color: #666;
            margin-top: 5px;
        }

        .input-area {
            padding: 20px 30px;
            background: rgba(255, 255, 255, 0.05);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .input-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .message-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 15px 20px;
            color: #fff;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .message-input:focus {
            border-color: #00d4ff;
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.2);
        }

        .message-input::placeholder {
            color: #888;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            color: #fff;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .voice-btn.listening {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            animation: pulse 1s infinite;
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 8px;
            color: #888;
            font-style: italic;
            margin-bottom: 15px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #888;
            animation: typingDots 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingDots {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .error-message {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 12px;
            padding: 12px;
            color: #ff6b6b;
            margin-bottom: 15px;
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                padding: 15px;
            }
            
            .quick-actions {
                margin: 0;
            }
            
            .action-grid {
                display: flex;
                gap: 8px;
            }
            
            .status {
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="logo">
                <h1>JARVIS</h1>
                <p>Your AI Assistant</p>
            </div>
            
            <div class="quick-actions">
                <h3>Quick Actions</h3>
                <div class="action-grid">
                    <div class="action-btn" onclick="quickAction('news')">
                        <i class="fas fa-newspaper"></i>
                        News
                    </div>
                    <div class="action-btn" onclick="quickAction('weather')">
                        <i class="fas fa-cloud-sun"></i>
                        Weather
                    </div>
                    <div class="action-btn" onclick="quickAction('screenshot')">
                        <i class="fas fa-camera"></i>
                        Screenshot
                    </div>
                    <div class="action-btn" onclick="quickAction('whatsapp')">
                        <i class="fab fa-whatsapp"></i>
                        WhatsApp
                    </div>
                    <div class="action-btn" onclick="quickAction('youtube')">
                        <i class="fab fa-youtube"></i>
                        YouTube
                    </div>
                    <div class="action-btn" onclick="quickAction('calculate')">
                        <i class="fas fa-calculator"></i>
                        Calculate
                    </div>
                </div>
            </div>
            
            <div class="status">
                <h4>System Status</h4>
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span>Online & Ready</span>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h2>Chat with JARVIS</h2>
                <p>Your intelligent assistant is ready to help</p>
            </div>
            
            <div class="chat-container">
                <div class="welcome-message" id="welcomeMessage">
                    <h3>👋 Hello! I'm JARVIS</h3>
                    <p>I'm your AI assistant, ready to help you with various tasks. You can type your message below or use the microphone to speak with me. Try asking me about the weather, news, or any question you have!</p>
                    <div style="margin-top: 20px; color: #666;">
                        <small>💡 Try saying: "Hello Jarvis" or "What can you do?"</small>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages"></div>
                <div class="typing-indicator" id="typingIndicator">
                    <span>JARVIS is thinking</span>
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
                <div class="error-message" id="errorMessage"></div>
            </div>
            
            <div class="input-area">
                <div class="input-container">
                    <input 
                        type="text" 
                        class="message-input" 
                        id="messageInput" 
                        placeholder="Type your message or use voice..."
                        onkeypress="handleKeyPress(event)"
                    >
                    <button class="control-btn voice-btn" id="voiceBtn" onclick="toggleVoiceInput()">
                        <i class="fas fa-microphone" id="voiceIcon"></i>
                    </button>
                    <button class="control-btn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let isListening = false;
        let conversationStarted = false;

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function showTyping() {
            document.getElementById('typingIndicator').style.display = 'flex';
        }

        function hideTyping() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        function startConversation() {
            if (!conversationStarted) {
                document.getElementById('welcomeMessage').style.display = 'none';
                document.getElementById('chatMessages').style.display = 'flex';
                conversationStarted = true;
            }
        }

        function addMessage(text, type, timestamp) {
            startConversation();
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.innerHTML = type === 'user' ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.innerHTML = text.replace(/\n/g, '<br>');
            
            if (timestamp) {
                const time = document.createElement('div');
                time.className = 'message-time';
                time.textContent = timestamp;
                content.appendChild(time);
            }
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            messagesContainer.appendChild(messageDiv);
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addMessage(message, 'user', new Date().toLocaleTimeString());
            input.value = '';
            
            showTyping();
            
            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: message })
                });
                
                const data = await response.json();
                hideTyping();
                
                if (data.error) {
                    showError(data.error);
                } else {
                    addMessage(data.response, 'jarvis', new Date().toLocaleTimeString());
                    
                    // Auto-speak response
                    speakText(data.response);
                }
            } catch (error) {
                hideTyping();
                showError('Connection error. Please try again.');
                console.error('Error:', error);
            }
        }

        async function toggleVoiceInput() {
            const voiceBtn = document.getElementById('voiceBtn');
            const voiceIcon = document.getElementById('voiceIcon');
            
            if (isListening) return;
            
            isListening = true;
            voiceBtn.classList.add('listening');
            voiceIcon.className = 'fas fa-stop';
            
            try {
                const response = await fetch('/api/voice-input', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                const data = await response.json();
                
                if (data.error) {
                    showError(`Voice input error: ${data.error}`);
                } else {
                    document.getElementById('messageInput').value = data.speech_text;
                    sendMessage();
                }
            } catch (error) {
                showError('Voice input failed. Please try again.');
                console.error('Voice error:', error);
            } finally {
                isListening = false;
                voiceBtn.classList.remove('listening');
                voiceIcon.className = 'fas fa-microphone';
            }
        }

        async function speakText(text) {
            try {
                await fetch('/api/speak', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ text: text })
                });
            } catch (error) {
                console.error('TTS error:', error);
            }
        }

        async function quickAction(action) {
            showTyping();
            
            try {
                const response = await fetch('/api/quick-action', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ action: action })
                });
                
                const data = await response.json();
                hideTyping();
                
                if (data.error) {
                    showError(data.error);
                } else {
                    startConversation();
                    addMessage(`Quick action: ${action}`, 'user', new Date().toLocaleTimeString());
                    addMessage(data.response, 'jarvis', new Date().toLocaleTimeString());
                    speakText(data.response);
                }
            } catch (error) {
                hideTyping();
                showError('Quick action failed. Please try again.');
                console.error('Quick action error:', error);
            }
        }

        // Auto-focus on input
        document.getElementById('messageInput').focus();
        
        // Welcome speech
        window.addEventListener('load', () => {
            setTimeout(() => {
                speakText("Hello! I'm Jarvis, your AI assistant. How can I help you today?");
            }, 1000);
        });
    </script>
</body>
</html>